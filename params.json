{"name":"Financial nn","tagline":"","body":"# Beating the S&P 500 Using a Neural Network\r\n\r\n### Why Beat a Buy and Hold Strategy?\r\nTo make more money!\r\nWouldn't it be great to be able to teach a computer how to trade profitably and then sit back while it did all the work?  That is what this project is dedicated to.  Teaching a computer to make more money for you in the stock market then just buying the S&P 500 and holding it forever.  The reason for this is to increase my net worth, and just maybe yours too. \r\n\r\n### What\r\nTechnical analysis of the stock market has been around since the Dutch markets in the 17th century according to Wikipedia.  It is a method of predicting the future prices of securities by studying past market behavior.  Specifically technical analysis includes finding patterns in past price and volume data.  These patterns are then applied to the stock market in real-time.  I would like to teach a computer how to find patterns in historical stock market data and then look for those patterns developing in real-time in the stock market.  This is a very interesting problem because technician have use this same technique for hundreds of years to profit.  If a human can recognize these patterns in charts, a computer can also be trained to do so.  The difference is that a computer can do it more efficiently and react to the patterns much faster than any human could, maximizing profits.\r\n\r\n# the BIG idea\r\nSo now that we have a general understanding, the question is how can we teach a computer to make us money?  The answer is simple.  Neural Networks.\r\n\r\nNeural Networks are systems where interconnected \"neurons\" work together to find a solution.  They are presented with a set of inputs and based on previous experience or training they are able to come up with an expected output.  Neural networks have been used for handwriting recognition, speech recognition, image recognition and many other things.  Neural networks are able to recognize patterns, even in some cases patterns that their programmers didn't know were there.  For this reason my hope is that I can design a neural network that will be able to recognize patterns in the stock market and make profitable predictions based on those patterns.\r\n\r\nThe neural network I am using is based on a website (http://iamtrask.github.io/2015/07/12/basic-python-network/) entitled \"A Neural Network in 11 lines of Python.\"  The second neural network presented on that site is a simple one with one hidden layer and 4 inputs.  I have expanded this network to still have a single hidden layer, but my network contains 25 inputs.  A neural network needs to have sufficient inputs to find relevant data.\r\n\r\n#### Inputs\r\nThe question of what should the inputs be is a complicated one.  I have chosen technical indicators for the SPY, an ETF that tracks the S&P 500, to be my inputs.  There are many technical indicators to choose from, but I have boiled it down to use MACD, RSI, ATR and the SMA-10-day.   [Head](#heading) \r\nThe 25 inputs are made up of several technical indicators, their  : MACD, RSI, ATR, SMA-10-day.  These technical indicators are looked examined for buy signals, as well as compared to themselves yesterday and two days ago in order to detect the trend.\r\n#### Expected Outputs\r\nNow determined by a stop loss.  To build the training data I allow the system to risk 1% of its working capital.  Each morning I simulate a buy of the S&P 500.  I then look forward in historical data to see when the trade would be stopped buy loosing 1%.  At the time of the stop if I made more than 5% I call that a buy and set the expected output to 1 for that day.  Otherwise it is set to 0.\r\n\r\n![output_code](https://cloud.githubusercontent.com/assets/10660367/11338993/733cae56-91b4-11e5-9cc5-ac91ed0c14b4.PNG)\r\n\r\n#heading\r\n\r\n### Current Test\r\nRuns for 265 trading days, but the error doesn't reduce to a usable number.  The neural network is still not being trained, the data still looks random.\r\n\r\n### Results\r\n#### Example of Error Reduction\r\n![error_good](https://cloud.githubusercontent.com/assets/10660367/11338320/a0750f52-91b0-11e5-9ac7-3e69fc420e60.PNG)\r\n\r\n#### My Error Reduction\r\n![error_chart](https://cloud.githubusercontent.com/assets/10660367/11338325/a7c3728a-91b0-11e5-97cf-edb80f06e906.PNG)\r\n\r\n#### My Error Changing\r\n![error_changing](https://cloud.githubusercontent.com/assets/10660367/11338321/a63ec478-91b0-11e5-9a5d-699bc98e1f5f.PNG)\r\n\r\n#### My Error Settling\r\n![errors_end](https://cloud.githubusercontent.com/assets/10660367/11338330/aa6b163c-91b0-11e5-9e56-396330c3a011.PNG)\r\n\r\n### Platform\r\nI have decided to use Quantopian as a tool to help expand my wealth.  Quantopian is a \"crowd-sourced hedge fund that provides the world's first browser-based algorithmic trading platform. On our platform, you can write code to execute your investment strategies, instead of relying on manual trades and emotional urges.\"  (Quote taken from https://www.quantopian.com/faq)\r\nThe idea behind Quantopian is that they provide an in-browser platform which allows the user to write python algorithms to trade the stock market.  You are provided with years of historical data and functions which help you access that data efficiently.  They have built in functions to run back tests and provide useful feedback as to your algorithms risks and rewards.\r\nQuantopian does have its drawbacks however.  It is relatively new and it currently only supports 20 python modules that can be imported.  This makes some things more difficult but I decided to give it a try.  If you are interested in this type of thing I would recommend you try it out as well.  Quantopian recently joined forces with RobinHood (a commission free trading platform) to allow you to trade real money with algorithms created and tested on Quantopian.\r\n\r\n###Chosen Technical Indicators\r\n#### Moving Average Convergence Divergence (MACD)\r\nThe MACD helps traders determine the future movement in a given security.  The MACD incorporates several moving averages into a single signal to find trends in a stock.  This technical indicator consists of two chart lines the MACD line and the signal line.  The MACD line is made up of the difference between the 26 day exponential moving average and the 12 day exponential moving average.  The signal line is made up of the 9 day moving average.  When the MACD is below the signal line and crosses above it this is a bullish signal, or a signal to buy.  When the MACD is above the signal line and crosses under it this is considered a bearish or sell signal.\r\n\r\nThe MACD indicator is illustrated in the chart below.  The MACD is drawn below a price chart of an unnamed stock. The solid line is the MACD and the dotted line is the signal line.  As can be seen at the arrow labeled \"Downward Cross,\" when the MACD line crosses below the signal line the price of the stock (drawn above) falls.  Then at the arrow labeled \"Upward Cross\" the MACD line crosses above the signal line and the price of the security subsequently increases.\r\n\r\n![macd](https://cloud.githubusercontent.com/assets/10660367/11763082/12c1ac74-a0ba-11e5-98cf-79fcfeb4790f.PNG)\r\n\r\n#### Relative Strength Index (RSI)\r\nThe RSI is a technical indicator that allows uses momentum to create buy and sell signals.  It basically compares the magnitude of recent gains to recent losses.  The formula for computing this is as follows: RS = Average of x days' up closes / Average of x days' down closes.  Plug RS into the following formula to get: RSI = 100 - 100/(1 + RS).  A typical value for x (and the one I used) is 14 days.  So What this formula does is takes the average daily gain of a stock divided by the average daily loss of a stock over a 14 day period.  It then normalizes those results to be between 0 and 100.  If the RSI of a stock is below 30 it is considered oversold and may be due to increase in price.  If the RSI of a stock is above 70 it is considered overbought and a decline in stock price may be expected.  \r\n\r\nThe chart below shows the RSI plotted under a nameless stock.  Times when the RSI is oversold (under 30) and overbought (above 70) are indicated by a red circle.  As can be seen by the activity of the stock price above the RSI often and overbought signal will see an increase in stock price, but it isn't always immediate.\r\n\r\n![rsi](https://cloud.githubusercontent.com/assets/10660367/11763258/ad0f2fd0-a0c0-11e5-9657-582864c38ab1.PNG)\r\n\r\n#### Average True Range (ATR)\r\nATR is a volatility indicator for financial markets.  Volatility is an important indicator which measures the strength of the price action, it can be used to separate \"strong\" moves from \"weak\" moves.  Obviously we want to participate in the strong moves.  Alone the ATR doesn't give an indication of which direction the price of a stock will move, but only how volatile the move will be.  However, many trades use a strategy in which the ATR is added to the previous day's close.  Then the next day if the price of a stock is greater than the previous close + the ATR that is considered a buy signal.  Like the other indicators, ATR uses several days of data to come up with it's value.  In this case we again are using 14 days.  The formula is as follows :  Current ATR = [(Prior ATR x 13) + Current TR] / 14 where the TR is the high-low for the day.  The formula needs a beginning, so for the first day the ATR is simply the high minus the low, and from there on the formula works out.\r\n\r\nBelow is a chart indicating a buy strategy using the ATR.  The black line is the price of the SPY, an S&P 500 exchange traded fund.  The previous days close is added to the ATR and that is indicated by a red dot.  Buy signals are generated when the price rises above the red dot for the day.\r\n\r\n![atr](https://cloud.githubusercontent.com/assets/10660367/11763327/600f8696-a0c3-11e5-8280-81d2c027bc7a.PNG)\r\n\r\n#### Simple Moving Average (SMA)\r\nThe Simple Moving Average is the mean of the price of a stock over a certain period.  For example, to calculate the 10 day SMA you add together the price of the stock for the last 10 days and then divide it by 10.  The longer the period the smoother and less reactive the SMA will be.  Moving averages as little as a couple days and as many as 17 months are used by traders.  We will use the 10 day moving average to generate buy and sell signals.  When the price of a stock is below the 10 day moving average then that stock is in a downward trend.  This is saying that todays price is less than the average of the last 10 days.  The opposite is true when the price of a stock is above the 10 day SMA.  This is illustrated below where the 20 day SMA is plotted as a solid black line over a candlestick chart of SPY.  \r\n\r\n![sma10](https://cloud.githubusercontent.com/assets/10660367/11763393/d78e9598-a0c5-11e5-891c-e57c4c904427.PNG)\r\n\r\n\r\n### Code\r\n<https://www.quantopian.com/algorithms/5639a0b7fb216fed200000bf>\r\n\r\n### Authors and Contributors\r\nYou can @mention a GitHub username to generate a link to their profile. The resulting `<a>` element will link to the contributor’s GitHub Profile. For example: In 2007, Chris Wanstrath (@defunkt), PJ Hyett (@pjhyett), and Tom Preston-Werner (@mojombo) founded GitHub.\r\n\r\n### Support or Contact\r\nHaving trouble with Pages? Check out our [documentation](https://help.github.com/pages) or [contact support](https://github.com/contact) and we’ll help you sort it out.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}